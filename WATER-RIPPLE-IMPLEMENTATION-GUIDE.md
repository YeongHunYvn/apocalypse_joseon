# 물방울 파동 효과 단계별 구현 가이드

이 가이드는 물방울 파동 효과를 점진적으로 구현하면서 각 단계를 독립적으로 테스트할 수 있도록 구성되었습니다.

## 🎯 최종 목표
터치 위치에서 시작하여 3개의 동심원 파동이 순차적으로 퍼져나가며, 화면 전체에 울렁임 효과를 주는 물방울 애니메이션

---

## 📋 단계별 체크리스트

### 1단계: Skia Canvas 기본 투명도 테스트
**목표**: Skia Canvas가 투명 배경에서 제대로 동작하는지 확인

#### 구현 내용
- [ ] 기본 Skia Canvas 컴포넌트 생성
- [ ] 화면 전체를 덮는 투명 오버레이 설정
- [ ] 빨간색 작은 원 하나를 화면 중앙에 고정으로 표시

#### 테스트 방법
- [ ] 기존 콘텐츠가 그대로 보이는지 확인
- [ ] 빨간 원이 명확하게 보이는지 확인
- [ ] Canvas 배경이 투명한지 확인 (검정색이 아닌지)

#### 성공 기준
✅ 기존 UI 위에 빨간 원이 투명하게 오버레이됨

---

### 2단계: 단일 파동 Circle stroke 테스트
**목표**: stroke 스타일로 원의 테두리만 그리기

#### 구현 내용
- [ ] 1단계의 채워진 원을 stroke 원으로 변경
- [ ] strokeWidth를 3으로 설정
- [ ] 파란색 테두리 원으로 화면 중앙에 고정 표시

#### 테스트 방법
- [ ] 원의 테두리만 보이고 안쪽이 투명한지 확인
- [ ] 기존 콘텐츠가 원 안쪽에서도 보이는지 확인

#### 성공 기준
✅ 파란색 테두리만 있는 투명한 원이 표시됨

---

### 3단계: 반지름 애니메이션 추가
**목표**: 원이 작은 크기에서 큰 크기로 애니메이션되는지 확인

#### 구현 내용
- [ ] useSharedValue로 radius 상태 관리
- [ ] withTiming을 사용하여 0에서 200까지 애니메이션
- [ ] 1.5초 지속시간으로 설정
- [ ] 컴포넌트 마운트 시 애니메이션 자동 시작

#### 테스트 방법
- [ ] 원이 점에서 시작하여 점점 커지는지 확인
- [ ] 애니메이션이 부드럽게 진행되는지 확인
- [ ] 여전히 투명 배경인지 확인

#### 성공 기준
✅ 파란색 원이 중심에서 바깥으로 부드럽게 확장됨

---

### 4단계: 투명도 애니메이션 추가
**목표**: 원이 커질수록 점점 투명해지는 효과

#### 구현 내용
- [ ] useDerivedValue로 투명도 계산
- [ ] 반지름이 커질수록 opacity가 1 → 0으로 변화
- [ ] 초기 opacity를 0.8에서 시작

#### 테스트 방법
- [ ] 원이 시작할 때는 진하게 보이는지 확인
- [ ] 원이 커질수록 점점 투명해지는지 확인
- [ ] 최종에는 거의 보이지 않는지 확인

#### 성공 기준
✅ 파동이 퍼져나가며 자연스럽게 페이드아웃됨

---

### 5단계: 다중 파동 구현
**목표**: 3개의 동심원이 순차적으로 나타나는 효과

#### 구현 내용
- [ ] 3개의 독립적인 Circle 컴포넌트 생성
- [ ] 각각 다른 지연 시간 설정 (0ms, 150ms, 300ms)
- [ ] 각각 다른 strokeWidth 설정 (3, 2, 1)
- [ ] 각각 다른 최대 투명도 설정 (0.8, 0.6, 0.4)

#### 테스트 방법
- [ ] 첫 번째 파동이 먼저 시작되는지 확인
- [ ] 두 번째, 세 번째 파동이 순차적으로 시작되는지 확인
- [ ] 3개 파동이 동시에 진행되는지 확인

#### 성공 기준
✅ 3개의 동심원이 순차적으로 퍼져나감

---

### 6단계: 터치 위치 연동
**목표**: 파동이 터치한 위치에서 시작되도록 설정

#### 구현 내용
- [ ] Props로 centerX, centerY 받도록 인터페이스 수정
- [ ] Circle의 cx, cy를 Props 값으로 설정
- [ ] 테스트용으로 다양한 위치에서 파동 생성해보기

#### 테스트 방법
- [ ] 화면 중앙에서 파동 테스트
- [ ] 화면 모서리에서 파동 테스트
- [ ] 다양한 위치에서 파동이 정상 동작하는지 확인

#### 성공 기준
✅ 지정된 좌표에서 파동이 정확히 시작됨

---

### 7단계: StoryScrollView 터치 감지 연동
**목표**: 실제 길게 누르기 위치를 파동 효과로 전달

#### 구현 내용
- [ ] StoryScrollView의 터치 이벤트에서 좌표 추출
- [ ] onLongPressComplete 콜백에 좌표 정보 추가
- [ ] StoryScreen에서 터치 좌표를 파동 컴포넌트로 전달

#### 테스트 방법
- [ ] 다양한 위치에서 길게 누르기 테스트
- [ ] 파동이 정확한 터치 위치에서 시작되는지 확인
- [ ] 스크롤 중이 아닌 정적 터치에서만 동작하는지 확인

#### 성공 기준
✅ 길게 누른 위치에서 정확히 파동이 시작됨

---

### 8단계: 화면 울렁임 효과 추가
**목표**: 파동과 함께 전체 화면이 미세하게 울렁이는 효과

#### 구현 내용
- [ ] 별도의 화면 스케일 애니메이션 추가
- [ ] 1.0 → 1.02 → 1.0으로 미세한 scale 변화
- [ ] 파동 애니메이션과 동시에 실행
- [ ] 짧은 지속시간 (200ms 확대, 800ms 복원)

#### 테스트 방법
- [ ] 화면 전체가 미세하게 움직이는지 확인
- [ ] 울렁임이 과하지 않고 자연스러운지 확인
- [ ] 파동과 타이밍이 잘 맞는지 확인

#### 성공 기준
✅ 파동과 함께 화면이 자연스럽게 울렁임

---

### 9단계: 중심 물방울 효과 추가
**목표**: 파동 중심에 작은 물방울이 생겼다 사라지는 효과

#### 구현 내용
- [ ] 중심에 작은 채워진 원 (반지름 8) 추가
- [ ] 파동 시작과 함께 나타났다가 빠르게 사라지는 애니메이션
- [ ] 진한 색상으로 물방울 느낌 연출

#### 테스트 방법
- [ ] 중심 물방울이 명확하게 보이는지 확인
- [ ] 파동보다 빠르게 사라지는지 확인
- [ ] 물방울 같은 느낌이 나는지 확인

#### 성공 기준
✅ 중심에서 물방울이 떨어진 듯한 효과

---

### 10단계: 성능 최적화 및 정리
**목표**: 애니메이션 성능 최적화 및 메모리 누수 방지

#### 구현 내용
- [ ] 애니메이션 완료 후 상태 정리
- [ ] useEffect cleanup 함수 구현
- [ ] 불필요한 리렌더링 방지
- [ ] 애니메이션 도중 컴포넌트 언마운트 시 안전한 정리

#### 테스트 방법
- [ ] 여러 번 반복 실행해도 메모리 누수 없는지 확인
- [ ] 애니메이션 도중 화면 전환 시 문제없는지 확인
- [ ] 성능 프로파일링으로 FPS 확인

#### 성공 기준
✅ 안정적이고 부드러운 애니메이션 성능

---

## 🚨 주요 주의사항

### Skia 관련
- Canvas의 투명도 문제가 발생하면 React Native Animated.View로 대체 고려
- Paint 컴포넌트의 style="stroke" 확실히 설정
- antiAlias={true} 설정으로 부드러운 렌더링

### 성능 관련
- 동시에 여러 파동 효과 실행 시 성능 저하 주의
- useDerivedValue 사용으로 불필요한 계산 최소화
- 애니메이션 완료 후 즉시 정리

### UX 관련
- 파동 효과가 기존 UI 조작을 방해하지 않도록 pointerEvents="none" 설정
- 길게 누르기와 일반 터치/스크롤 구분 명확히

---

## 📝 각 단계별 독립 테스트 팁

1. **각 단계마다 별도 컴포넌트로 구현**하여 독립적으로 테스트
2. **console.log로 애니메이션 값 추적**하여 예상대로 동작하는지 확인
3. **다양한 디바이스에서 테스트**하여 성능 차이 확인
4. **단계별로 성공하면 다음 단계로 진행**, 문제 발생 시 이전 단계로 롤백

이 가이드를 따라하면 각 단계마다 확실한 결과물을 확인하면서 안전하게 구현할 수 있습니다! 🌊✨ 