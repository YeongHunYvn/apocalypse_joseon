# 🚨 시나리오 작성 필수 규칙

시나리오 작성 시 반드시 지켜야 할 규칙과 체크리스트입니다.

## 📁 챕터 작성 규칙

### ✅ 필수 요구사항
- [ ] `chapter_common.json` 파일 존재 (`/assets/chapters/` 위치)
- [ ] 필수 씬 3개 포함: `scn_game_start`, `scn_game_over`, `scn_game_victory`
- [ ] 챕터 구조가 [SCENARIO-TYPE-REFERENCE.md](./SCENARIO-TYPE-REFERENCE.md)의 `Chapter` 타입에 맞음

### ⚠️ 금지사항
- ❌ 필수 씬 누락 (엔진에서 직접 참조함)
- ❌ 잘못된 챕터 타입 사용 (`rest` | `story` 외)

## 🎭 씬 작성 규칙

### 공통 규칙 (모든 씬 타입)

#### ✅ 필수 요구사항
- [ ] 씬 ID: `scn_` 접두어로 시작, 프로젝트 내 고유
- [ ] 메인 텍스트: `text` 필드 작성 필수
- [ ] 선택지: `choices` 배열에 최소 1개 이상
- [ ] 선택지 텍스트: 모든 선택지에 `text` 필드 필수
- [ ] 정의된 ID만 사용:
  - 능력치: `constants/gameConfig.ts`의 `STATS`
  - 상태(버프): `/assets/config/buffs.json`
  - 플래그: `/assets/config/flags.json`
  - 아이템: `/assets/config/items.json`
  - 스킬: `/assets/config/skills.json`

#### ⚠️ 금지사항
- ❌ 씬 ID 중복
- ❌ 정의되지 않은 ID 사용
- ❌ 무한 루프 (자기 자신으로만 이동, 종료 조건 없음)
- ❌ 사망 가능한 효과에서 사망 처리 누락
- ❌ 스킬을 `manual_level_up` 대상으로 지정 (스킬은 자동 레벨업만 지원)

#### 🔗 씬 연결 규칙
- [ ] 연속된 씬의 시작 씬: `"random_selectable": true` 설정 필수

#### 💀 사망 처리 규칙
체력/정신력 감소 효과가 있는 씬은 **반드시** 다음 중 하나를 구현:

**방법 1: `conditional_text` 사용**
- 효과 적용 후 조건부 텍스트로 바로 휴식방으로 이동

**방법 2: 조건부 선택지 + 공통 죽음 씬**
- 조건부 선택지로 공통 죽음 씬(`scn_death_1`)으로 이동

### 타입별 규칙

#### 메인 씬 (`type: "main"`)
- [ ] 부별 구성: 1부, 2부, 3부 등으로 나누어 작성
- [ ] 진행 조건: 2부부터 이전 부 완료 조건 확인 (`completed_scenes`)
- [ ] 장소 이동: 각 부 완료 시 텍스트 상 장소 이동 처리 (이야기 흐름을 매끄럽게 하기 위함)
- [ ] 분기 일관성: 메인에서 분기된 모든 씬도 `type: "main"` 유지
- [ ] 분기 막힘 처리: 더이상 메인 시나리오를 이어갈 수 없는 경우 강제 게임오버(`force_gameover: true`) 고려

#### 사이드 씬 (`type: "side"`)
- [ ] 부별 구성: 사이드도 부별로 나누어 작성
- [ ] 진행 조건: 이전 부의 마지막 씬 완료를 조건으로 설정 권장
- [ ] 분기 일관성: 사이드에서 분기된 모든 씬도 `type: "side"` 유지

#### 이벤트 씬 (`type: "event"`)
- [ ] 반복성 고려: 조건으로 반복 횟수나 조건 제한
- [ ] 랜덤 선택: `"random_selectable": true` 명시적 설정 필요요

## ✅ 작성 완료 체크리스트

### 📁 챕터 최종 검사
- [ ] `chapter_common.json` 파일 존재
- [ ] 필수 씬 3개 포함
- [ ] 챕터 타입 인터페이스 준수

### 🎭 씬 최종 검사
- [ ] 씬 ID 고유성 (`scn_` 접두어)
- [ ] 텍스트/선택지 누락 없음
- [ ] 정의된 ID만 사용
- [ ] JSON 문법 올바름
- [ ] 사망 처리 구현
- [ ] 타입별 규칙 준수

### 🎮 게임 플로우 검사
- [ ] 무한 루프 없음
- [ ] 모든 경로에서 진행 가능
- [ ] 게임오버 조건 적절히 처리 